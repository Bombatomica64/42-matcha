<div class="chat-layout">
  <div class="chat-main">
    <div class="chat-messages">
      @if (messages().length === 0) {
      <div class="no-messages">
        <p>No messages yet. Start the conversation!</p>
      </div>
      } @else {
      <p-virtual-scroller
        #chatScroller
        [items]="messages()"
        [itemSize]="50"
        styleClass="chat-scroller"
        (onScrollIndexChange)="onIndexChange($event)"
      >
        <ng-template pTemplate="item" let-message>
          <app-chat-message
            [content]="message"
            [options]="{ isOwnMessage: message.sender_id === currentUserId() }"
          ></app-chat-message>
        </ng-template>
      </p-virtual-scroller>
      }
    </div>
    <!-- <om-border-beam class="chat-beam-full"> -->
    <form
      class="composer"
      (submit)="sendMessage(messageInput); $event.preventDefault()"
      autocomplete="off"
    >
      <div class="composer-inner">
        <p-float-label variant="on">
          <input
            #messageInput
            id="chatMessageInput"
            type="text"
            pInputText
            (keydown.enter)="sendMessage(messageInput)"
            class="composer-input"
          />
          <label for="chatMessageInput">Type a message...</label>
        </p-float-label>
        <button
          type="submit"
          class="p-button p-component p-button-icon-only composer-send"
          [disabled]="!messageInput.value.trim()"
        >
          <i class="pi pi-send"></i>
          <span class="p-button-label p-c">Send</span>
        </button>
      </div>
    </form>
    <!-- </om-border-beam> -->
  </div>
</div>

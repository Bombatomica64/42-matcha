<div class="chat-layout">
  <div class="chat-main">
    <div class="chat-messages">
      @if (messages().length === 0) {
      <div class="no-messages">
        <p>No messages yet. Start the conversation!</p>
      </div>
      } @else {
      <p-virtual-scroller
        #chatScroller
        [items]="messages()"
        [itemSize]="50"
        styleClass="chat-scroller"
        (onScrollIndexChange)="onIndexChange($event)"
      >
        <ng-template pTemplate="item" let-message>
          <app-chat-message
            [content]="message"
            [options]="{ isOwnMessage: message.sender_id === currentUserId() }"
          ></app-chat-message>
        </ng-template>
      </p-virtual-scroller>
      }
    </div>
    <!-- <om-border-beam class="chat-beam-full"> -->
    <form class="composer" (submit)="sendMessage(messageInput); $event.preventDefault()" autocomplete="off">
      <div class="composer-pill">
        <textarea
          #messageInput
          id="chatMessageInput"
          placeholder="Type a message..."
          class="composer-textarea"
          rows="1"
          (input)="autoGrow(messageInput)"
          (keydown.enter)="onEnter($any($event), messageInput)"
        ></textarea>
        <button
          type="submit"
          pButton
          icon="pi pi-send"
          [disabled]="!messageInput.value.trim()"
          class="composer-send"
          severity="primary"
          variant="text"
          aria-label="Send message"
        ></button>
      </div>
    </form>
    <!-- </om-border-beam> -->
  </div>
</div>
